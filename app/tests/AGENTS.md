# AGENTS.md

Рекомендации по тестированию.

- Структура тестов зеркалирует `app/`.
- Юнит-тесты находятся в `app/tests/unit`, не используют внешние сервисы и опираются на фикстуры из `conftest.py`.
- Интеграционные тесты живут в `app/tests/integration`; перед запуском поднимаются зависимости через Docker Compose.
- Запуск всех тестов: `pytest -q`. Для интеграционных добавьте `--runintegration`.
- Покрытие: `pytest --cov=app --cov-report=xml:coverage.xml --cov-report=html --cov-fail-under=85 -q`.
- Следуйте TDD: при добавлении логики пишите минимальные тесты сразу.
- Best practices: используйте фикстуры для подготовки окружения, избегайте сохранения состояния, давайте тестам говорящие имена, выносите общую логику в helpers, применяйте `pytest.mark.parametrize`, один тест — одна проверка.
- Подробности об инфраструктуре смотрите в `app/tests/integration/AGENTS.md`.
