# Additional event templates

## Цель
Добавить новые шаблоны событий и описать их применение.

## Контекст
Потребовались новые типы фактов для графа: смена личности, создание
предметов, фиксация конфликтов и разрушений.

## Мотивация
Расширение набора базовых шаблонов облегчает наполнение графа и
позволяет проверять новые варианты извлечения.

## Польза
Граф поддерживает больше сценариев и единообразно хранит сведения о
событиях.

## Планируемые изменения
- Расширить `base_templates` четырьмя новыми записями.
- Создать jinja‑шаблоны для вставки и агментации каждого события.
- Обновить индекс `prompts_index.md`.

## Локация
- `app/templates/base.py`
- `app/templates/cypher/*.j2`
- `docs/prompts_index.md`

## Альтернативы
Можно было хранить такие факты через общие свойства, но индивидуальные
шаблоны проще использовать и валидировать.

## Деплой
Миграций не требуется. Достаточно пересоздать встроенные шаблоны в
Weaviate при старте сервиса.

## Проверка
Каждый шаблон повторяет структуру уже работающих:
- `identity_change_v1` создаёт связь `FORMER_IDENTITY` между текущей и
  прошлой личностью.
- `item_creation_v1` связывает персонажа фактом `HAS_CREATED_ITEM`.
- `conflict_event_v1` отмечает, что персонаж кого‑то атаковал через
  `HAS_ATTACKED`.
- `destruction_event_v1` помечает объект или место как уничтоженное,
  аналогично `death_event_v1` для персонажей.

## Меры на будущее
Добавить интеграционные тесты, создающие временный граф и проверяющие,
что связи формируются корректно.

## Отчёт
После внедрения сервис загружает новые шаблоны без ошибок, и их можно
использовать в пайплайнах извлечения и агментации.
