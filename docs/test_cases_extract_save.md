# Тест-кейсы для эндпойнта `/v1/extract-save`

Ниже перечислены базовые сценарии, которые следует покрыть юнит- и интеграционными тестами.

## Валидация входных данных
* **Нет токена** — отсутствие заголовка `Authorization` возвращает 401.
* **Слишком длинный текст** — более 1000 символов приводит к 422.
* **Неверный номер главы** — `chapter < 1` приводит к 422.
* **Неизвестный этап** — `stage` с неописанным значением выдаёт 422.

## Успешный вызов
* При валидном запросе ответ содержит `chunk_id` и `raptor_node_id`.
* Список `relationships` отражает созданные связи.
* `aliases` возвращает все записанные упоминания.
* `chunk_id` используется для связи всех выходных сущностей.
* `raptor_node_id` сохраняется в `Chunk`.
* Поле `details` из SlotFiller сохраняется в `relationships` и на новых узлах Alias.

Тесты, реализующие эти сценарии, находятся в `app/tests/unit/api/test_extract_save_endpoint.py`.

Эти кейсы описывают минимальный набор проверок работоспособности пайплайна
и корректности схемы Pydantic.
